"MiniAEFrame" — オープンスクリプティングアーキテクチャサーバのサポート
**********************************************************************

"MiniAEFrame" モジュールは、アプリケーションにオープンスクリプティング
アーキテクチャ (OSA) サーバ機能を持たせるためのフレームワークを提供し
ます。つまり、AppleEvents の受信と処理を行わせます。 "FrameWork" と連
携させても良いし、単独でも使えます。実例として、このモジュールは
**PythonCGISlave** の中で使われています。

"MiniAEFrame" には以下のクラスが定義されています:

class MiniAEFrame.AEServer

   AppleEvent の分岐を処理するクラス。作成するアプリケーションはこのク
   ラスと、 "MiniApplication" あるいは "FrameWork.Application" のサブ
   クラスでなければなりません。サブクラス化したクラスでは "__init__()"
   メソッドで、継承した両方のクラスの "__init__()" メソッドを呼びださ
   なければなりません。

class MiniAEFrame.MiniApplication

   "FrameWork.Application" とある程度互換なクラスですが、機能は少ない
   です。このクラスのイベントループはアップルメニュー、 Cmd-.(コマンド
   キーを押しながらピリオド.を押す)、 AppleEvent をサポートします。他
   のイベントは Python インタープリタか Sioux（CodeWarrior のコンソー
   ルシステム）に渡されます。作成するアプリケーションで "AEServer" を
   使いたいが、独自のウィンドウなどを持たない場合に便利です。


AEServer オブジェクト
=====================

AEServer.installaehandler(classe, type, callback)

   AppleEvent ハンドラをインストールします。 *classe* と *type* は4 文
   字の OSA クラスとタイプの指定子で、ワイルドカード "'****'" も使えま
   す。対応する AppleEvent を受けるとパラメータがデコードされ、与えた
   コールバックが呼び出されます。

AEServer.callback(_object, **kwargs)

   与えたコールバックは、OSA ダイレクトオブジェクトを 1 番目のパラメー
   タとして呼び出されます。他のパラメータは 4 文字の指定子を名前にした
   キーワード引数として渡されます。他に 3 つのキーワード・パラメータが
   渡されます。つまり、 "_class" と "_type" はクラスとタイプ指定子で、
   "_attributes" は AppleEvent 属性を持つ辞書です。

   与えたメソッドの返り値は "aetools.packevent()" でパックされ、リプラ
   イとして送られます。

現在のクラス設計にはいくつか重大な問題があることに注意してください。引
数に名前ではない 4 文字の指定子を持つ AppleEvent はまだ実装されていな
いし、イベントの送信側にエラーを返すこともできません。この問題は将来の
リリースまで先送りにされています。
